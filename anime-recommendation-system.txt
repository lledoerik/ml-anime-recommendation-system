{
 "cells": [
  {
   "cell_type": "code",
   "id": "initial_id",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T02:21:09.072746Z",
     "start_time": "2025-10-27T02:21:07.299871Z"
    }
   },
   "source": [
    "import pandas as pd\n",
    "\n",
    "r_cols = ['user_id', 'anime_id', 'rating']\n",
    "ratings = pd.read_csv('data/rating.csv', usecols=r_cols)\n",
    "\n",
    "a_cols = ['anime_id', 'name', 'members']\n",
    "animes = pd.read_csv('data/anime.csv', usecols=a_cols, encoding='UTF8')\n",
    "\n",
    "ratings = pd.merge(ratings, animes)\n",
    "\n",
    "ratings.head()"
   ],
   "outputs": [
    {
     "data": {
      "text/plain": [
       "   user_id  anime_id  rating                       name  members\n",
       "0        1        20      -1                     Naruto   683297\n",
       "1        1        24      -1              School Rumble   178553\n",
       "2        1        79      -1                   Shuffle!   158772\n",
       "3        1       226      -1                 Elfen Lied   623511\n",
       "4        1       241      -1  Girls Bravo: First Season    84395"
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>anime_id</th>\n",
       "      <th>rating</th>\n",
       "      <th>name</th>\n",
       "      <th>members</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>20</td>\n",
       "      <td>-1</td>\n",
       "      <td>Naruto</td>\n",
       "      <td>683297</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>-1</td>\n",
       "      <td>School Rumble</td>\n",
       "      <td>178553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>79</td>\n",
       "      <td>-1</td>\n",
       "      <td>Shuffle!</td>\n",
       "      <td>158772</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>226</td>\n",
       "      <td>-1</td>\n",
       "      <td>Elfen Lied</td>\n",
       "      <td>623511</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>241</td>\n",
       "      <td>-1</td>\n",
       "      <td>Girls Bravo: First Season</td>\n",
       "      <td>84395</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 1
  },
  {
   "cell_type": "code",
   "id": "57a701656f53802f",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T02:21:19.481417Z",
     "start_time": "2025-10-27T02:21:09.139348Z"
    }
   },
   "source": [
    "ratings = ratings[ratings['rating'] != -1]\n",
    "\n",
    "anime_counts = ratings['anime_id'].value_counts()\n",
    "ratings = ratings[ratings['anime_id'].isin(anime_counts[anime_counts > 50].index)]\n",
    "\n",
    "user_anime_ratings = ratings.pivot_table(index='user_id', columns='name', values='rating')\n",
    "\n",
    "user_anime_ratings.head()"
   ],
   "outputs": [
    {
     "data": {
      "text/plain": [
       "name     &quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hatsukoi  \\\n",
       "user_id                                                        \n",
       "1                                                      NaN     \n",
       "2                                                      NaN     \n",
       "3                                                      NaN     \n",
       "5                                                      NaN     \n",
       "7                                                      NaN     \n",
       "\n",
       "name     &quot;Bungaku Shoujo&quot; Memoire  &quot;Bungaku Shoujo&quot; Movie  \\\n",
       "user_id                                                                         \n",
       "1                                       NaN                               NaN   \n",
       "2                                       NaN                               NaN   \n",
       "3                                       NaN                               NaN   \n",
       "5                                       NaN                               NaN   \n",
       "7                                       NaN                               NaN   \n",
       "\n",
       "name     .hack//G.U. Returner  .hack//G.U. Trilogy  \\\n",
       "user_id                                              \n",
       "1                         NaN                  NaN   \n",
       "2                         NaN                  NaN   \n",
       "3                         NaN                  NaN   \n",
       "5                         NaN                  NaN   \n",
       "7                         NaN                  NaN   \n",
       "\n",
       "name     .hack//G.U. Trilogy: Parody Mode  .hack//Gift  .hack//Intermezzo  \\\n",
       "user_id                                                                     \n",
       "1                                     NaN          NaN                NaN   \n",
       "2                                     NaN          NaN                NaN   \n",
       "3                                     NaN          NaN                NaN   \n",
       "5                                     NaN          NaN                NaN   \n",
       "7                                     NaN          NaN                NaN   \n",
       "\n",
       "name     .hack//Liminality  .hack//Quantum  ...  ef: A Tale of Memories.  \\\n",
       "user_id                                     ...                            \n",
       "1                      NaN             NaN  ...                      NaN   \n",
       "2                      NaN             NaN  ...                      NaN   \n",
       "3                      NaN             NaN  ...                      NaN   \n",
       "5                      NaN             NaN  ...                      NaN   \n",
       "7                      NaN             NaN  ...                      NaN   \n",
       "\n",
       "name     ef: A Tale of Memories. - Prologue  \\\n",
       "user_id                                       \n",
       "1                                       NaN   \n",
       "2                                       NaN   \n",
       "3                                       NaN   \n",
       "5                                       NaN   \n",
       "7                                       NaN   \n",
       "\n",
       "name     ef: A Tale of Memories. - Recollections  iDOLM@STER Xenoglossia  \\\n",
       "user_id                                                                    \n",
       "1                                            NaN                     NaN   \n",
       "2                                            NaN                     NaN   \n",
       "3                                            NaN                     NaN   \n",
       "5                                            NaN                     NaN   \n",
       "7                                            NaN                     NaN   \n",
       "\n",
       "name     s.CRY.ed  xxxHOLiC  xxxHOLiC Kei  \\\n",
       "user_id                                     \n",
       "1             NaN       NaN           NaN   \n",
       "2             NaN       NaN           NaN   \n",
       "3             NaN       NaN           NaN   \n",
       "5             NaN       2.0           NaN   \n",
       "7             NaN       NaN           NaN   \n",
       "\n",
       "name     xxxHOLiC Movie: Manatsu no Yoru no Yume  xxxHOLiC Rou  \\\n",
       "user_id                                                          \n",
       "1                                            NaN           NaN   \n",
       "2                                            NaN           NaN   \n",
       "3                                            NaN           NaN   \n",
       "5                                            NaN           NaN   \n",
       "7                                            NaN           NaN   \n",
       "\n",
       "name     xxxHOLiC Shunmuki  \n",
       "user_id                     \n",
       "1                      NaN  \n",
       "2                      NaN  \n",
       "3                      NaN  \n",
       "5                      NaN  \n",
       "7                      NaN  \n",
       "\n",
       "[5 rows x 5152 columns]"
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>name</th>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Kyou no Oyatsu: Hatsukoi</th>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Memoire</th>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Movie</th>\n",
       "      <th>.hack//G.U. Returner</th>\n",
       "      <th>.hack//G.U. Trilogy</th>\n",
       "      <th>.hack//G.U. Trilogy: Parody Mode</th>\n",
       "      <th>.hack//Gift</th>\n",
       "      <th>.hack//Intermezzo</th>\n",
       "      <th>.hack//Liminality</th>\n",
       "      <th>.hack//Quantum</th>\n",
       "      <th>...</th>\n",
       "      <th>ef: A Tale of Memories.</th>\n",
       "      <th>ef: A Tale of Memories. - Prologue</th>\n",
       "      <th>ef: A Tale of Memories. - Recollections</th>\n",
       "      <th>iDOLM@STER Xenoglossia</th>\n",
       "      <th>s.CRY.ed</th>\n",
       "      <th>xxxHOLiC</th>\n",
       "      <th>xxxHOLiC Kei</th>\n",
       "      <th>xxxHOLiC Movie: Manatsu no Yoru no Yume</th>\n",
       "      <th>xxxHOLiC Rou</th>\n",
       "      <th>xxxHOLiC Shunmuki</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>user_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 5152 columns</p>\n",
       "</div>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 2
  },
  {
   "cell_type": "code",
   "id": "67d6f2d7a76293f7",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T02:29:39.357522Z",
     "start_time": "2025-10-27T02:21:20.111750Z"
    }
   },
   "source": [
    "corr_matrix = user_anime_ratings.corr(method='pearson', min_periods=50)\n",
    "corr_matrix.head()"
   ],
   "outputs": [
    {
     "data": {
      "text/plain": [
       "name                                                &quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hatsukoi  \\\n",
       "name                                                                                                      \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                                           1.000000     \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                                           0.744635     \n",
       "&quot;Bungaku Shoujo&quot; Movie                                                             0.637777     \n",
       ".hack//G.U. Returner                                                                              NaN     \n",
       ".hack//G.U. Trilogy                                                                          0.454444     \n",
       "\n",
       "name                                                &quot;Bungaku Shoujo&quot; Memoire  \\\n",
       "name                                                                                     \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                            0.744635   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                            1.000000   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                              0.765973   \n",
       ".hack//G.U. Returner                                                          0.556470   \n",
       ".hack//G.U. Trilogy                                                           0.388148   \n",
       "\n",
       "name                                                &quot;Bungaku Shoujo&quot; Movie  \\\n",
       "name                                                                                   \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                          0.637777   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                          0.765973   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                            1.000000   \n",
       ".hack//G.U. Returner                                                        0.466480   \n",
       ".hack//G.U. Trilogy                                                         0.368030   \n",
       "\n",
       "name                                                .hack//G.U. Returner  \\\n",
       "name                                                                       \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                   NaN   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                              0.556470   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                0.466480   \n",
       ".hack//G.U. Returner                                            1.000000   \n",
       ".hack//G.U. Trilogy                                             0.698365   \n",
       "\n",
       "name                                                .hack//G.U. Trilogy  \\\n",
       "name                                                                      \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...             0.454444   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                             0.388148   \n",
       "&quot;Bungaku Shoujo&quot; Movie                               0.368030   \n",
       ".hack//G.U. Returner                                           0.698365   \n",
       ".hack//G.U. Trilogy                                            1.000000   \n",
       "\n",
       "name                                                .hack//G.U. Trilogy: Parody Mode  \\\n",
       "name                                                                                   \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                               NaN   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                               NaN   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                                 NaN   \n",
       ".hack//G.U. Returner                                                        0.620506   \n",
       ".hack//G.U. Trilogy                                                         0.633177   \n",
       "\n",
       "name                                                .hack//Gift  \\\n",
       "name                                                              \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...     0.594027   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                     0.445039   \n",
       "&quot;Bungaku Shoujo&quot; Movie                       0.374839   \n",
       ".hack//G.U. Returner                                   0.617314   \n",
       ".hack//G.U. Trilogy                                    0.552365   \n",
       "\n",
       "name                                                .hack//Intermezzo  \\\n",
       "name                                                                    \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...           0.603640   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                           0.474940   \n",
       "&quot;Bungaku Shoujo&quot; Movie                             0.452996   \n",
       ".hack//G.U. Returner                                         0.673917   \n",
       ".hack//G.U. Trilogy                                          0.554392   \n",
       "\n",
       "name                                                .hack//Liminality  \\\n",
       "name                                                                    \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...           0.472422   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                           0.536322   \n",
       "&quot;Bungaku Shoujo&quot; Movie                             0.473985   \n",
       ".hack//G.U. Returner                                         0.598627   \n",
       ".hack//G.U. Trilogy                                          0.512949   \n",
       "\n",
       "name                                                .hack//Quantum  ...  \\\n",
       "name                                                                ...   \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...        0.441831  ...   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                        0.431886  ...   \n",
       "&quot;Bungaku Shoujo&quot; Movie                          0.404275  ...   \n",
       ".hack//G.U. Returner                                      0.533943  ...   \n",
       ".hack//G.U. Trilogy                                       0.471152  ...   \n",
       "\n",
       "name                                                ef: A Tale of Memories.  \\\n",
       "name                                                                          \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                 0.334864   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                 0.351132   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                   0.388724   \n",
       ".hack//G.U. Returner                                               0.354862   \n",
       ".hack//G.U. Trilogy                                                0.402542   \n",
       "\n",
       "name                                                ef: A Tale of Memories. - Prologue  \\\n",
       "name                                                                                     \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                            0.348514   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                            0.265461   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                              0.230482   \n",
       ".hack//G.U. Returner                                                          0.262569   \n",
       ".hack//G.U. Trilogy                                                           0.346342   \n",
       "\n",
       "name                                                ef: A Tale of Memories. - Recollections  \\\n",
       "name                                                                                          \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                                      NaN   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                                      NaN   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                                   0.086442   \n",
       ".hack//G.U. Returner                                                                    NaN   \n",
       ".hack//G.U. Trilogy                                                                     NaN   \n",
       "\n",
       "name                                                iDOLM@STER Xenoglossia  \\\n",
       "name                                                                         \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                     NaN   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                     NaN   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                  0.456714   \n",
       ".hack//G.U. Returner                                                   NaN   \n",
       ".hack//G.U. Trilogy                                                    NaN   \n",
       "\n",
       "name                                                s.CRY.ed  xxxHOLiC  \\\n",
       "name                                                                     \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...  0.138261  0.374278   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                  0.098599  0.331379   \n",
       "&quot;Bungaku Shoujo&quot; Movie                    0.173804  0.232156   \n",
       ".hack//G.U. Returner                                0.417124  0.246732   \n",
       ".hack//G.U. Trilogy                                 0.395361  0.237799   \n",
       "\n",
       "name                                                xxxHOLiC Kei  \\\n",
       "name                                                               \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...      0.492078   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                      0.391796   \n",
       "&quot;Bungaku Shoujo&quot; Movie                        0.335691   \n",
       ".hack//G.U. Returner                                    0.327878   \n",
       ".hack//G.U. Trilogy                                     0.322899   \n",
       "\n",
       "name                                                xxxHOLiC Movie: Manatsu no Yoru no Yume  \\\n",
       "name                                                                                          \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...                                 0.457717   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                                                 0.379595   \n",
       "&quot;Bungaku Shoujo&quot; Movie                                                   0.324071   \n",
       ".hack//G.U. Returner                                                               0.379263   \n",
       ".hack//G.U. Trilogy                                                                0.328929   \n",
       "\n",
       "name                                                xxxHOLiC Rou  \\\n",
       "name                                                               \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...      0.447106   \n",
       "&quot;Bungaku Shoujo&quot; Memoire                      0.407135   \n",
       "&quot;Bungaku Shoujo&quot; Movie                        0.361359   \n",
       ".hack//G.U. Returner                                    0.343318   \n",
       ".hack//G.U. Trilogy                                     0.324105   \n",
       "\n",
       "name                                                xxxHOLiC Shunmuki  \n",
       "name                                                                   \n",
       "&quot;Bungaku Shoujo&quot; Kyou no Oyatsu: Hats...           0.435606  \n",
       "&quot;Bungaku Shoujo&quot; Memoire                           0.394739  \n",
       "&quot;Bungaku Shoujo&quot; Movie                             0.301690  \n",
       ".hack//G.U. Returner                                         0.301565  \n",
       ".hack//G.U. Trilogy                                          0.226928  \n",
       "\n",
       "[5 rows x 5152 columns]"
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>name</th>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Kyou no Oyatsu: Hatsukoi</th>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Memoire</th>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Movie</th>\n",
       "      <th>.hack//G.U. Returner</th>\n",
       "      <th>.hack//G.U. Trilogy</th>\n",
       "      <th>.hack//G.U. Trilogy: Parody Mode</th>\n",
       "      <th>.hack//Gift</th>\n",
       "      <th>.hack//Intermezzo</th>\n",
       "      <th>.hack//Liminality</th>\n",
       "      <th>.hack//Quantum</th>\n",
       "      <th>...</th>\n",
       "      <th>ef: A Tale of Memories.</th>\n",
       "      <th>ef: A Tale of Memories. - Prologue</th>\n",
       "      <th>ef: A Tale of Memories. - Recollections</th>\n",
       "      <th>iDOLM@STER Xenoglossia</th>\n",
       "      <th>s.CRY.ed</th>\n",
       "      <th>xxxHOLiC</th>\n",
       "      <th>xxxHOLiC Kei</th>\n",
       "      <th>xxxHOLiC Movie: Manatsu no Yoru no Yume</th>\n",
       "      <th>xxxHOLiC Rou</th>\n",
       "      <th>xxxHOLiC Shunmuki</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Kyou no Oyatsu: Hatsukoi</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.744635</td>\n",
       "      <td>0.637777</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.454444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.594027</td>\n",
       "      <td>0.603640</td>\n",
       "      <td>0.472422</td>\n",
       "      <td>0.441831</td>\n",
       "      <td>...</td>\n",
       "      <td>0.334864</td>\n",
       "      <td>0.348514</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.138261</td>\n",
       "      <td>0.374278</td>\n",
       "      <td>0.492078</td>\n",
       "      <td>0.457717</td>\n",
       "      <td>0.447106</td>\n",
       "      <td>0.435606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Memoire</th>\n",
       "      <td>0.744635</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.765973</td>\n",
       "      <td>0.556470</td>\n",
       "      <td>0.388148</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.445039</td>\n",
       "      <td>0.474940</td>\n",
       "      <td>0.536322</td>\n",
       "      <td>0.431886</td>\n",
       "      <td>...</td>\n",
       "      <td>0.351132</td>\n",
       "      <td>0.265461</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.098599</td>\n",
       "      <td>0.331379</td>\n",
       "      <td>0.391796</td>\n",
       "      <td>0.379595</td>\n",
       "      <td>0.407135</td>\n",
       "      <td>0.394739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>&amp;quot;Bungaku Shoujo&amp;quot; Movie</th>\n",
       "      <td>0.637777</td>\n",
       "      <td>0.765973</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.466480</td>\n",
       "      <td>0.368030</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.374839</td>\n",
       "      <td>0.452996</td>\n",
       "      <td>0.473985</td>\n",
       "      <td>0.404275</td>\n",
       "      <td>...</td>\n",
       "      <td>0.388724</td>\n",
       "      <td>0.230482</td>\n",
       "      <td>0.086442</td>\n",
       "      <td>0.456714</td>\n",
       "      <td>0.173804</td>\n",
       "      <td>0.232156</td>\n",
       "      <td>0.335691</td>\n",
       "      <td>0.324071</td>\n",
       "      <td>0.361359</td>\n",
       "      <td>0.301690</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>.hack//G.U. Returner</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.556470</td>\n",
       "      <td>0.466480</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.698365</td>\n",
       "      <td>0.620506</td>\n",
       "      <td>0.617314</td>\n",
       "      <td>0.673917</td>\n",
       "      <td>0.598627</td>\n",
       "      <td>0.533943</td>\n",
       "      <td>...</td>\n",
       "      <td>0.354862</td>\n",
       "      <td>0.262569</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.417124</td>\n",
       "      <td>0.246732</td>\n",
       "      <td>0.327878</td>\n",
       "      <td>0.379263</td>\n",
       "      <td>0.343318</td>\n",
       "      <td>0.301565</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>.hack//G.U. Trilogy</th>\n",
       "      <td>0.454444</td>\n",
       "      <td>0.388148</td>\n",
       "      <td>0.368030</td>\n",
       "      <td>0.698365</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.633177</td>\n",
       "      <td>0.552365</td>\n",
       "      <td>0.554392</td>\n",
       "      <td>0.512949</td>\n",
       "      <td>0.471152</td>\n",
       "      <td>...</td>\n",
       "      <td>0.402542</td>\n",
       "      <td>0.346342</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.395361</td>\n",
       "      <td>0.237799</td>\n",
       "      <td>0.322899</td>\n",
       "      <td>0.328929</td>\n",
       "      <td>0.324105</td>\n",
       "      <td>0.226928</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 5152 columns</p>\n",
       "</div>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 3
  },
  {
   "cell_type": "code",
   "id": "45b43d77ce2f6bd",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T09:16:54.472108Z",
     "start_time": "2025-10-27T09:16:54.466635Z"
    }
   },
   "source": [
    "anime_corr = (corr_matrix['Elfen Lied'].dropna().sort_values(ascending=False))\n",
    "anime_corr.head(10)"
   ],
   "outputs": [
    {
     "data": {
      "text/plain": [
       "name\n",
       "Elfen Lied                                              1.000000\n",
       "Elfen Lied Special                                      0.726527\n",
       "Shinmai Maou no Testament Specials                      0.674829\n",
       "Luger Code 1951                                         0.666899\n",
       "Marginal Prince: Gekkeiju no Ouji-tachi                 0.608772\n",
       "Nurse Witch Komugi-chan R                               0.606776\n",
       "D.C. I&amp;II P.S.P. Re-Animated                        0.596175\n",
       "Black Jack: Futari no Kuroi Isha                        0.587962\n",
       "Nagato Yuki-chan no Shoushitsu: Owarenai Natsuyasumi    0.569492\n",
       "Blade &amp; Soul Specials                               0.562001\n",
       "Name: Elfen Lied, dtype: float64"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 49
  },
  {
   "cell_type": "code",
   "id": "34b0dd78d5056675",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T08:58:14.902363Z",
     "start_time": "2025-10-27T08:58:14.559652Z"
    }
   },
   "source": [
    "anime_stats = ratings.groupby('name').agg({'rating': ['size', 'mean']})\n",
    "popular_animes = anime_stats['rating']['size'] >= 100\n",
    "anime_stats[popular_animes].sort_values([('rating', 'mean')], ascending=False).head(10)"
   ],
   "outputs": [
    {
     "data": {
      "text/plain": [
       "                                                   rating          \n",
       "                                                     size      mean\n",
       "name                                                               \n",
       "Gintama°                                             1188  9.449495\n",
       "Kimi no Na wa.                                       1961  9.426313\n",
       "Ginga Eiyuu Densetsu                                  803  9.389788\n",
       "Fullmetal Alchemist: Brotherhood                    21494  9.322741\n",
       "Gintama&#039;                                        3115  9.272552\n",
       "Steins;Gate                                         17151  9.261326\n",
       "Gintama                                              4264  9.236398\n",
       "Hunter x Hunter (2011)                               7477  9.234586\n",
       "Gintama&#039;: Enchousen                             2126  9.202258\n",
       "Gintama Movie: Kanketsu-hen - Yorozuya yo Eien ...   2147  9.191430"
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"2\" halign=\"left\">rating</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>size</th>\n",
       "      <th>mean</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Gintama°</th>\n",
       "      <td>1188</td>\n",
       "      <td>9.449495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Kimi no Na wa.</th>\n",
       "      <td>1961</td>\n",
       "      <td>9.426313</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ginga Eiyuu Densetsu</th>\n",
       "      <td>803</td>\n",
       "      <td>9.389788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fullmetal Alchemist: Brotherhood</th>\n",
       "      <td>21494</td>\n",
       "      <td>9.322741</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Gintama&amp;#039;</th>\n",
       "      <td>3115</td>\n",
       "      <td>9.272552</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Steins;Gate</th>\n",
       "      <td>17151</td>\n",
       "      <td>9.261326</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Gintama</th>\n",
       "      <td>4264</td>\n",
       "      <td>9.236398</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Hunter x Hunter (2011)</th>\n",
       "      <td>7477</td>\n",
       "      <td>9.234586</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Gintama&amp;#039;: Enchousen</th>\n",
       "      <td>2126</td>\n",
       "      <td>9.202258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Gintama Movie: Kanketsu-hen - Yorozuya yo Eien Nare</th>\n",
       "      <td>2147</td>\n",
       "      <td>9.191430</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 32
  },
  {
   "cell_type": "code",
   "id": "8b819de78ec4e9a3",
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T09:16:28.298772Z",
     "start_time": "2025-10-27T09:16:28.287653Z"
    }
   },
   "source": [
    "anime_stats_df = anime_stats[popular_animes].reset_index()\n",
    "\n",
    "sim_df = anime_corr.reset_index()\n",
    "sim_df.columns = ['name', 'similarity']\n",
    "\n",
    "df = pd.merge(anime_stats_df, sim_df, on='name', how='inner')\n",
    "df = (df.sort_values('similarity', ascending=False))\n",
    "\n",
    "df.head(10)"
   ],
   "outputs": [
    {
     "data": {
      "text/plain": [
       "                                                   name  rating_size  \\\n",
       "937                                          Elfen Lied        23528   \n",
       "938                                  Elfen Lied Special         5802   \n",
       "3360                 Shinmai Maou no Testament Specials          106   \n",
       "2295            Marginal Prince: Gekkeiju no Ouji-tachi          145   \n",
       "679                    D.C. I&amp;II P.S.P. Re-Animated          113   \n",
       "2515  Nagato Yuki-chan no Shoushitsu: Owarenai Natsu...          166   \n",
       "3088                              Rurouni Kenshin Recap          125   \n",
       "2058                Kyoushirou to Towa no Sora Specials          110   \n",
       "1005  Final Fantasy VII: Advent Children - Venice Fi...          206   \n",
       "3070                                  Rockman.EXE Beast          105   \n",
       "\n",
       "      rating_mean  similarity  \n",
       "937      8.064434    1.000000  \n",
       "938      7.447949    0.726527  \n",
       "3360     6.877358    0.674829  \n",
       "2295     6.455172    0.608772  \n",
       "679      6.955752    0.596175  \n",
       "2515     7.054217    0.569492  \n",
       "3088     7.720000    0.561163  \n",
       "2058     6.909091    0.560942  \n",
       "1005     7.728155    0.559577  \n",
       "3070     7.380952    0.558936  "
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating_size</th>\n",
       "      <th>rating_mean</th>\n",
       "      <th>similarity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>937</th>\n",
       "      <td>Elfen Lied</td>\n",
       "      <td>23528</td>\n",
       "      <td>8.064434</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>938</th>\n",
       "      <td>Elfen Lied Special</td>\n",
       "      <td>5802</td>\n",
       "      <td>7.447949</td>\n",
       "      <td>0.726527</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3360</th>\n",
       "      <td>Shinmai Maou no Testament Specials</td>\n",
       "      <td>106</td>\n",
       "      <td>6.877358</td>\n",
       "      <td>0.674829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2295</th>\n",
       "      <td>Marginal Prince: Gekkeiju no Ouji-tachi</td>\n",
       "      <td>145</td>\n",
       "      <td>6.455172</td>\n",
       "      <td>0.608772</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>679</th>\n",
       "      <td>D.C. I&amp;amp;II P.S.P. Re-Animated</td>\n",
       "      <td>113</td>\n",
       "      <td>6.955752</td>\n",
       "      <td>0.596175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2515</th>\n",
       "      <td>Nagato Yuki-chan no Shoushitsu: Owarenai Natsu...</td>\n",
       "      <td>166</td>\n",
       "      <td>7.054217</td>\n",
       "      <td>0.569492</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3088</th>\n",
       "      <td>Rurouni Kenshin Recap</td>\n",
       "      <td>125</td>\n",
       "      <td>7.720000</td>\n",
       "      <td>0.561163</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2058</th>\n",
       "      <td>Kyoushirou to Towa no Sora Specials</td>\n",
       "      <td>110</td>\n",
       "      <td>6.909091</td>\n",
       "      <td>0.560942</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1005</th>\n",
       "      <td>Final Fantasy VII: Advent Children - Venice Fi...</td>\n",
       "      <td>206</td>\n",
       "      <td>7.728155</td>\n",
       "      <td>0.559577</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3070</th>\n",
       "      <td>Rockman.EXE Beast</td>\n",
       "      <td>105</td>\n",
       "      <td>7.380952</td>\n",
       "      <td>0.558936</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 48
  },
  {
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T09:27:54.347093Z",
     "start_time": "2025-10-27T09:27:54.338202Z"
    }
   },
   "cell_type": "code",
   "source": [
    "user_id = 12\n",
    "my_ratings = ratings[ratings['user_id'] == user_id][['name', 'rating']]\n",
    "my_ratings.head(10)"
   ],
   "id": "aac770da5575e2ab",
   "outputs": [
    {
     "data": {
      "text/plain": [
       "                                                   name  rating\n",
       "1282                                        Dragon Ball       8\n",
       "1283                                     Dragon Ball GT       6\n",
       "1284                                Mirai Shounen Conan       9\n",
       "1285                                    Yuu☆Yuu☆Hakusho       9\n",
       "1286                                      Dragon Ball Z       9\n",
       "1287                             Ouran Koukou Host Club       9\n",
       "1288                                               Nana       9\n",
       "1289                                         Death Note      10\n",
       "1290                      Yamato Nadeshiko Shichihenge♥       9\n",
       "1291                    Code Geass: Hangyaku no Lelouch      10\n",
       "1292              Darker than Black: Kuro no Keiyakusha       9\n",
       "1293                 Code Geass: Hangyaku no Lelouch R2      10\n",
       "1294      Darker than Black: Kuro no Keiyakusha Special       7\n",
       "1295                   Fullmetal Alchemist: Brotherhood       9\n",
       "1296                                    Dragon Ball Kai       9\n",
       "1297               Darker than Black: Ryuusei no Gemini       9\n",
       "1298       Darker than Black: Kuro no Keiyakusha Gaiden       9\n",
       "1299                             Highschool of the Dead       6\n",
       "1300  Code Geass: Boukoku no Akito 1 - Yokuryuu wa M...       9\n",
       "1301                                        Steins;Gate      10\n",
       "1302                                   Sword Art Online       9\n",
       "1303                                 Shingeki no Kyojin      10"
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1282</th>\n",
       "      <td>Dragon Ball</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1283</th>\n",
       "      <td>Dragon Ball GT</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1284</th>\n",
       "      <td>Mirai Shounen Conan</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1285</th>\n",
       "      <td>Yuu☆Yuu☆Hakusho</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1286</th>\n",
       "      <td>Dragon Ball Z</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1287</th>\n",
       "      <td>Ouran Koukou Host Club</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1288</th>\n",
       "      <td>Nana</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1289</th>\n",
       "      <td>Death Note</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1290</th>\n",
       "      <td>Yamato Nadeshiko Shichihenge♥</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1291</th>\n",
       "      <td>Code Geass: Hangyaku no Lelouch</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1292</th>\n",
       "      <td>Darker than Black: Kuro no Keiyakusha</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1293</th>\n",
       "      <td>Code Geass: Hangyaku no Lelouch R2</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1294</th>\n",
       "      <td>Darker than Black: Kuro no Keiyakusha Special</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1295</th>\n",
       "      <td>Fullmetal Alchemist: Brotherhood</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1296</th>\n",
       "      <td>Dragon Ball Kai</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1297</th>\n",
       "      <td>Darker than Black: Ryuusei no Gemini</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1298</th>\n",
       "      <td>Darker than Black: Kuro no Keiyakusha Gaiden</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1299</th>\n",
       "      <td>Highschool of the Dead</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1300</th>\n",
       "      <td>Code Geass: Boukoku no Akito 1 - Yokuryuu wa M...</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1301</th>\n",
       "      <td>Steins;Gate</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1302</th>\n",
       "      <td>Sword Art Online</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1303</th>\n",
       "      <td>Shingeki no Kyojin</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 53
  },
  {
   "metadata": {
    "ExecuteTime": {
     "end_time": "2025-10-27T09:52:26.237522Z",
     "start_time": "2025-10-27T09:52:26.201288Z"
    }
   },
   "cell_type": "code",
   "source": [
    "my_anime_ratings = pd.Series(data=my_ratings['rating'].values, index=my_ratings['name'])\n",
    "\n",
    "sim_candidates = pd.Series(dtype=float)\n",
    "\n",
    "for anime, rating in my_anime_ratings.items():\n",
    "    if anime not in corr_matrix.columns:\n",
    "        continue\n",
    "    sims = corr_matrix[anime].dropna()\n",
    "    sims = sims.map(lambda x: x * rating)\n",
    "    sim_candidates = pd.concat([sim_candidates, sims])\n",
    "\n",
    "sim_candidates = sim_candidates.groupby(sim_candidates.index).sum()\n",
    "\n",
    "sim_candidates = sim_candidates.drop(my_anime_ratings.index, errors='ignore')\n",
    "\n",
    "sim_candidates = sim_candidates.sort_values(ascending=False)\n",
    "\n",
    "recommendations = pd.DataFrame({'name': sim_candidates.index, 'score': sim_candidates.values})\n",
    "\n",
    "recommendations = recommendations.merge(animes[['name', 'members']], on='name', how='left')\n",
    "\n",
    "recommendations.head(10)"
   ],
   "id": "50a794f3a4e0d491",
   "outputs": [
    {
     "data": {
      "text/plain": [
       "                                                name      score  members\n",
       "0                                            Heroman  69.603315    23405\n",
       "1  Mahou Shoujo Lyrical Nanoha: The Movie 2nd A&#...  68.461572    13315\n",
       "2                Mobile Suit Gundam 00 Second Season  68.101434    86972\n",
       "3                           Morita-san wa Mukuchi. 2  67.845304     8788\n",
       "4                     Towa no Quon 3: Mugen no Renza  67.307821    19053\n",
       "5                                           Major S4  67.011983    28002\n",
       "6                 Seikon no Qwaser: Jotei no Shouzou  66.893796    14605\n",
       "7                               Zoids Shinseiki/Zero  66.835035    16381\n",
       "8               Saint Seiya: Meiou Hades Elysion-hen  66.698889    19044\n",
       "9                Saint Seiya: Meiou Hades Meikai-hen  66.658263    21240"
      ],
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>score</th>\n",
       "      <th>members</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Heroman</td>\n",
       "      <td>69.603315</td>\n",
       "      <td>23405</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Mahou Shoujo Lyrical Nanoha: The Movie 2nd A&amp;#...</td>\n",
       "      <td>68.461572</td>\n",
       "      <td>13315</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Mobile Suit Gundam 00 Second Season</td>\n",
       "      <td>68.101434</td>\n",
       "      <td>86972</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Morita-san wa Mukuchi. 2</td>\n",
       "      <td>67.845304</td>\n",
       "      <td>8788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Towa no Quon 3: Mugen no Renza</td>\n",
       "      <td>67.307821</td>\n",
       "      <td>19053</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Major S4</td>\n",
       "      <td>67.011983</td>\n",
       "      <td>28002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Seikon no Qwaser: Jotei no Shouzou</td>\n",
       "      <td>66.893796</td>\n",
       "      <td>14605</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Zoids Shinseiki/Zero</td>\n",
       "      <td>66.835035</td>\n",
       "      <td>16381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Saint Seiya: Meiou Hades Elysion-hen</td>\n",
       "      <td>66.698889</td>\n",
       "      <td>19044</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Saint Seiya: Meiou Hades Meikai-hen</td>\n",
       "      <td>66.658263</td>\n",
       "      <td>21240</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "execution_count": 75
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
